#?????????????? ????????????
cat("\014")
options(max.print=1000000)

#???????????????????? ?????????????????? ???????????????????????????????????? 1: ?????????????????????? ??????????????????????????, 1000 ??????????, ???? 1 ???? 3
n <- 1000
a1 <- 1
b1 <- 3
pockets <- 11
sequence1 <- runif(n, a1, b1)
#?????????????? ????????????????????????????????????
print(paste(sequence1))

#?????????????? ?????????????????????????? ????????????????????????????:
mn1 <- mean(sequence1)
var1 <- var(sequence1)
sd1 <- sd(sequence1)
median1 <- median(sequence1)
chars1 <- c(mn1, var1, sd1, median1)
rowNames1 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars1)
row.names(dataframe) <- rowNames1
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????????????????????????? ???1")
dataframe


#???????????????????? ?????????????????? ???????????????????????????????????? 2: ?????????????????????? ??????????????????????????, 1000 ??????????, ???? 2 ???? 4
a2 <- 2
b2 <- 4
pockets <- 11
sequence2 <- runif(n, a2, b2)
#?????????????? ????????????????????????????????????
print(paste(sequence2))

#?????????????? ?????????????????????????? ????????????????????????????:
mn2 <- mean(sequence2)
var2 <- var(sequence2)
sd2 <- sd(sequence2)
median2 <- median(sequence2)
chars2 <- c(mn2, var2, sd2, median2)
rowNames2 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars2)
row.names(dataframe) <- rowNames2
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????????????????????????? ???2")
dataframe


#???????????????????? ?????????????????? ???????????????????????????????????? 3: ?????????????????????? ??????????????????????????, 1000 ??????????, ???? 3 ???? 5
a3 <- 3
b3 <- 5
pockets <- 11
sequence3 <- runif(n, a3, b3)

#?????????????? ????????????????????????????????????
print(paste(sequence3))

#?????????????? ?????????????????????????? ????????????????????????????:
mn3 <- mean(sequence3)
var3 <- var(sequence3)
sd3 <- sd(sequence3)
median3 <- median(sequence3)
chars3 <- c(mn3, var3, sd3, median3)
rowNames3 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars3)
row.names(dataframe) <- rowNames3
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????????????????????????? ???3")
dataframe


#???????????????????? ?????????????????? ???????????????????????????????????? 4: ?????????????????????? ??????????????????????????, 1000 ??????????, ???? 4 ???? 6
a4 <- 4
b4 <- 6
pockets <- 11
sequence4 <- runif(n, a4, b4)

#?????????????? ????????????????????????????????????
print(paste(sequence4))

#?????????????? ?????????????????????????? ????????????????????????????:
mn4 <- mean(sequence4)
var4 <- var(sequence4)
sd4 <- sd(sequence4)
median4 <- median(sequence4)
chars4 <- c(mn4, var4, sd4, median4)
rowNames4 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars4)
row.names(dataframe) <- rowNames4
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????????????????????????? ???4")
dataframe

#???????????????????? ?????????????????? ???????????????????????????????????? 5: ?????????????????????? ??????????????????????????, 1000 ??????????, ???? 5 ???? 7
a5 <- 5
b5 <- 7
pockets <- 11
sequence5 <- runif(n, a5, b5)
#?????????????? ????????????????????????????????????
print(paste(sequence5))

#?????????????? ?????????????????????????? ????????????????????????????:
mn5 <- mean(sequence5)
var5 <- var(sequence5)
sd5 <- sd(sequence5)
median5 <- median(sequence5)
chars5 <- c(mn5, var5, sd5, median5)
rowNames5 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars5)
row.names(dataframe) <- rowNames5
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????????????????????????? ???5")
dataframe

#???????????????? ?????????? ?????????????????????????? 1 ?? 2; 1 ?? 3; 1 ?? 4; 1 ?? 5
sequence12 <- 1:n
for(i in 1:n){sequence12[i]= sequence1[i] + sequence2[i]}
sequence13 <- 1:n
for(i in 1:n){sequence13[i]= sequence1[i] + sequence3[i]}
sequence14 <- 1:n
for(i in 1:n){sequence14[i]= sequence1[i] + sequence4[i]}
sequence15 <- 1:n
for(i in 1:n){sequence15[i]= sequence1[i] + sequence5[i]}
#???????????????? ?? ?????????????? ?????????????????????????? ???????????????????????????? ???????? ?????????????????????????? 1 ?? 2; 1 ?? 3; 1 ?? 4; 1 ?? 5
mn12 <- mean(sequence12)
var12 <- var(sequence12)
sd12 <- sd(sequence12)
median12 <- median(sequence12)
chars12 <- c(mn12, var12, sd12, median12)
rowNames12 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars12)
row.names(dataframe) <- rowNames12
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????? ?????????? ?????????????????????????? 1 ?? 2")
dataframe

mn13 <- mean(sequence13)
var13 <- var(sequence13)
sd13 <- sd(sequence13)
median13 <- median(sequence13)
chars13 <- c(mn13, var13, sd13, median13)
rowNames13 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars13)
row.names(dataframe) <- rowNames13
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????? ?????????? ?????????????????????????? 1 ?? 3")
dataframe

mn14 <- mean(sequence14)
var14 <- var(sequence14)
sd14 <- sd(sequence14)
median14 <- median(sequence14)
chars14 <- c(mn14, var14, sd14, median14)
rowNames14 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars14)
row.names(dataframe) <- rowNames14
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????? ?????????? ?????????????????????????? 1 ?? 4")
dataframe

mn15 <- mean(sequence15)
var15 <- var(sequence15)
sd15 <- sd(sequence15)
median15 <- median(sequence15)
chars15 <- c(mn15, var15, sd15, median15)
rowNames15 <- c("??????????????:", "??????????????????:", "??????:", "??????????????:")
dataframe=data.frame(chars15)
row.names(dataframe) <- rowNames15
colnames(dataframe) <- c("?????????????????????????? ???????????????????????????? ?????? ?????? ?????????? ?????????????????????????? 1 ?? 5")
dataframe

#???????????????? ???????????? ?????? ?????????????????? ???????? ?????????????????????????? 1,2; 1,3 ; 1,4; 1,5
leftBound <- a1+a2
rightBound <- b1+b2
pocketBounds <- seq(leftBound, rightBound, length.out = pockets)
step = (rightBound - leftBound) / pockets
pocketCentres <- seq(leftBound - step/2, rightBound - step/2, length.out = pockets)
frequency = seq(0,0,length.out=pockets + 1)
frequency[1] = length(sequence12[sequence12 < pocketBounds[1]])
for(i in 2:pockets)
  frequency[i] = length(sequence12[sequence12 >= pocketBounds[i-1] & sequence12 < pocketBounds[i]])
frequency[pockets + 1] = length(sequence12[sequence12 >= pocketBounds[pockets]])
pocketCentres[pockets + 1] = pocketCentres[pockets] + pocketCentres[pockets] - pocketCentres[pockets - 1]
pocketBounds[pockets + 1] = pocketBounds[pockets] + pocketBounds[pockets] - pocketBounds[pockets - 1]

#?????????????? ???????????? ?????? ??????????????????
dataframe=data.frame(pocketCentres, pocketBounds, frequency)
print(dataframe)
cat("?????????? ????????????????????: ", sum(frequency))



#???????????? ??????????????????????
barplot(frequency, col = "red", names.arg = round(pocketCentres), xlab = "???????????? ????????????????", ylab = "??????????????", main = "?????????????????????? ?????????????????????????? ???????????? 1+2 ??????????????????????????")
leftBound <- a1+a3
rightBound <- b1+b3
pocketBounds <- seq(leftBound, rightBound, length.out = pockets)
step = (rightBound - leftBound) / pockets
pocketCentres <- seq(leftBound - step/2, rightBound - step/2, length.out = pockets)
frequency = seq(0,0,length.out=pockets + 1)
frequency[1] = length(sequence13[sequence13 < pocketBounds[1]])
for(i in 2:pockets)
  frequency[i] = length(sequence13[sequence13 >= pocketBounds[i-1] & sequence13 < pocketBounds[i]])
frequency[pockets + 1] = length(sequence13[sequence13 >= pocketBounds[pockets]])
pocketCentres[pockets + 1] = pocketCentres[pockets] + pocketCentres[pockets] - pocketCentres[pockets - 1]
pocketBounds[pockets + 1] = pocketBounds[pockets] + pocketBounds[pockets] - pocketBounds[pockets - 1]

#?????????????? ???????????? ?????? ??????????????????
dataframe=data.frame(pocketCentres, pocketBounds, frequency)
print(dataframe)
cat("?????????? ????????????????????: ", sum(frequency))

#???????????? ??????????????????????
barplot(frequency, col = "blue", names.arg = round(pocketCentres), xlab = "???????????? ????????????????", ylab = "??????????????", main = "?????????????????????? ?????????????????????????? ???????????? 1+3 ??????????????????????????")
leftBound <- a1+a4
rightBound <- b1+b4
pocketBounds <- seq(leftBound, rightBound, length.out = pockets)
step = (rightBound - leftBound) / pockets
pocketCentres <- seq(leftBound - step/2, rightBound - step/2, length.out = pockets)
frequency = seq(0,0,length.out=pockets + 1)
frequency[1] = length(sequence14[sequence14 < pocketBounds[1]])
for(i in 2:pockets)
  frequency[i] = length(sequence14[sequence14 >= pocketBounds[i-1] & sequence14 < pocketBounds[i]])
frequency[pockets + 1] = length(sequence14[sequence14 >= pocketBounds[pockets]])
pocketCentres[pockets + 1] = pocketCentres[pockets] + pocketCentres[pockets] - pocketCentres[pockets - 1]
pocketBounds[pockets + 1] = pocketBounds[pockets] + pocketBounds[pockets] - pocketBounds[pockets - 1]

#?????????????? ???????????? ?????? ??????????????????
dataframe=data.frame(pocketCentres, pocketBounds, frequency)
print(dataframe)
cat("?????????? ????????????????????: ", sum(frequency))

#???????????? ??????????????????????
barplot(frequency, col = "green", names.arg = round(pocketCentres), xlab = "???????????? ????????????????", ylab = "??????????????", main = "?????????????????????? ?????????????????????????? ???????????? 1+4 ??????????????????????????")
leftBound <- a1+a5
rightBound <- b1+b5
pocketBounds <- seq(leftBound, rightBound, length.out = pockets)
step = (rightBound - leftBound) / pockets
pocketCentres <- seq(leftBound - step/2, rightBound - step/2, length.out = pockets)
frequency = seq(0,0,length.out=pockets + 1)
frequency[1] = length(sequence15[sequence15 < pocketBounds[1]])
for(i in 2:pockets)
  frequency[i] = length(sequence15[sequence15 >= pocketBounds[i-1] & sequence15 < pocketBounds[i]])
frequency[pockets + 1] = length(sequence15[sequence15 >= pocketBounds[pockets]])
pocketCentres[pockets + 1] = pocketCentres[pockets] + pocketCentres[pockets] - pocketCentres[pockets - 1]
pocketBounds[pockets + 1] = pocketBounds[pockets] + pocketBounds[pockets] - pocketBounds[pockets - 1]

#?????????????? ???????????? ?????? ??????????????????
dataframe=data.frame(pocketCentres, pocketBounds, frequency)
print(dataframe)
cat("?????????? ????????????????????: ", sum(frequency))

#???????????? ??????????????????????
barplot(frequency, col = "yellow", names.arg = round(pocketCentres), xlab = "???????????? ????????????????", ylab = "??????????????", main = "?????????????????????? ?????????????????????????? ???????????? 1+5 ??????????????????????????")
#???????????? ?????????????????? ?????????????????????????? ????????????????????
seqmn <- c(mn12,mn13,mn14,mn15)
seqvar <- c(var12,var13,var14,var15)
seqsd <- c(sd12,sd13,sd14,sd15)
seqmedian <- c(median12,median13,median14,median15)
plot(seqmn,xlab='??????-???? ??????????????????????????',ylab= '????????????????',xlim = c(0,5),ylim=c(0,12), type ='o', col="red")
par(new=TRUE)
plot(seqvar,xlab='??????-???? ??????????????????????????',ylab= '????????????????',xlim = c(0,5),ylim=c(0,12), type ='o', col="blue")
par(new=TRUE)
plot(seqsd,xlab='??????-???? ??????????????????????????',ylab= '????????????????',xlim = c(0,5),ylim=c(0,12), type ='o', col="green")
par(new=TRUE)
plot(seqmedian,xlab='??????-???? ??????????????????????????',ylab= '????????????????',xlim = c(0,5),ylim=c(0,12), type ='o', col="black")

